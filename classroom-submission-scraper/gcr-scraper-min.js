const TIME_DELAY=1e3,LOOP_LIMIT=30;function ScrapeGrade(){return new Promise(e=>{let t=0,n=[],o=!0;!function i(){if(o&&t<30){t++;let a={},r=document.querySelector('div.A39x1.ScX2If.LMgvRb.KKjvXb[jsname="wQNmvb"]');if(r){let l=r.querySelector("div.UvCNFb.dE51Ic");l?a.name=l.textContent:console.log("Name div not found within the parent div.")}else console.log("Parent div for the name not found with the specified class and jsname.");let d=document.querySelector('[jscontroller="WPsbnb"]');if(d){let u=d.textContent,m=u.split("Turned in on");m.length>=2?a.time=m[1].trim():console.log("Date and time not found in the element.")}else console.log("Element not found with the specified jscontroller attribute for time.");let c=document.querySelector('input[jsname="YPqjbf"]');c?a.grade=c.getAttribute("data-initial-value"):console.log("Grade element not found."),a.name&&a.time&&a.grade?(console.log("Name:",a.name),console.log("Time:",a.time),console.log("Grade:",a.grade),n.push(a)):console.log("Name, time, or grade data not available."),o=function t(){let o=document.querySelector('div[jsname="KwmAGc"]');if(o){let i=o.getAttribute("aria-disabled");if("true"===i)return console.log("Button is disabled. Exiting the loop."),e(n),!1;setTimeout(()=>{o.click()},1e3)}else console.log("Button element not found with the specified jsname attribute.");return!0}(),setTimeout(i,1e3)}}()})}function convertToCSV(e){if(0===e.length){console.log("Data Array is empty. Cannot generate CSV.");return}let t=Object.keys(e[0]),n=[t.join(";")].concat(e.map(e=>t.map(t=>e[t]).join(";"))).join("\n");return n}ScrapeGrade().then(e=>{console.log("Data Array:",e);let t=convertToCSV(e);console.log(t)});