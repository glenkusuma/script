const TIME_DELAY=1e3,LOOP_LIMIT=30;function ScrapeGrade(){return new Promise(e=>{let t=0,n=[],r=!0;!function o(){if(r&&t<30){t++;let i={Name:function e(){let t=document.querySelector('div.A39x1.ScX2If.LMgvRb.KKjvXb[jsname="wQNmvb"]');if(!t)return console.log("Parent div for the name not found with the specified class and jsname."),"";let n=t.querySelector("div.UvCNFb.dE51Ic");return n?n.textContent:(console.log("Name div not found within the parent div."),"")}(),ProfileImage:function e(){let t=document.querySelector('div.A39x1.ScX2If.LMgvRb.KKjvXb[jsname="wQNmvb"]');if(!t)return console.log("Parent div for the name not found with the specified class and jsname."),"";let n=t.querySelector("img.sIXQKb.c4pfme.eBPtzb.BTx1Ob");return n?'=IMAGE("'+n.src+'")':(console.log("Image div not found within the parent div."),"")}(),Time:function e(){let t=document.querySelector('[jscontroller="WPsbnb"]');if(!t)return console.log("Element not found with the specified jscontroller attribute for time."),"";let n=t.textContent,r=n.split("Turned in on");return r.length>=2?r[1].trim():"Missing"}(),Grade:function e(){let t=document.querySelector('input[jsname="YPqjbf"]');return t?t.getAttribute("data-initial-value"):(console.log("Grade element not found."),"")}(),AttachedFileNames:function e(){let t=document.querySelector('div[jsname="XkqTFd"]');if(!t)return console.log("Attachment parent div not found with the specified jsname."),"";let n=t.querySelectorAll(".LYKue"),r=[];return n.forEach(e=>{let t=e.textContent;r.push(t)}),r.sort((e,t)=>{let n=e.split(".").pop(),r=t.split(".").pop();return n.localeCompare(r)}),r.join("||")}()};console.log("Name:",i.Name),console.log("Time:",i.Time),console.log("Grade:",i.Grade),console.log("Attached File Names:",i.AttachedFileNames),n.push(i),r=function e(){let t=document.querySelector('div[jsname="KwmAGc"]');if(!t)return console.log("Button element not found with the specified jsname attribute."),!1;let n=t.getAttribute("aria-disabled");return"true"==n?(console.log("Button is disabled. Exiting the loop."),!1):(setTimeout(()=>{t.click()},1e3),!0)}(),setTimeout(o,1e3)}else console.log("Loop:",t,"has been executed."),e(n)}()})}function convertToCSV(e){if(0===e.length)return console.log("Data Array is empty. Cannot generate CSV."),"";let t=Object.keys(e[0]),n=[t.join(";")].concat(e.map(e=>t.map(t=>e[t]).join(";"))).join("\n");return n}ScrapeGrade().then(e=>{console.log("Data Array:",e);let t=convertToCSV(e);console.log(t)});